from typing import Protocol, runtime_checkable

from jingwei.data.batch import Batch


@runtime_checkable
class BufferProtocol(Protocol):
    def add(self, batch: Batch) -> int: ...

    def is_full(self) -> bool: ...

    def clean(self) -> int: ...

    def sample(self, batch_size: int) -> Batch: ...

    def get(self, batch_size: int) -> Batch: ...


class ReplayBuffer(BufferProtocol, Protocol): ...


class RolloutBuffer(BufferProtocol, Protocol): ...
