from typing import Protocol

from jingwei.data.batch import Batch


class Buffer(Protocol):
    def add(self, batch: Batch) -> int: ...

    def is_full(self) -> bool: ...

    def clean(self) -> int: ...

    def sample(self, batch_size: int) -> Batch: ...

    def get(self, batch_size: int) -> Batch: ...


class ReplayBuffer(Protocol):
    def add(self, batch: Batch) -> int: ...

    def is_full(self) -> bool: ...

    def clean(self) -> int: ...

    def sample(self, batch_size: int) -> Batch: ...

    def get(self, batch_size: int) -> Batch: ...


class RolloutBuffer(Protocol):
    def add(self, batch: Batch) -> int: ...

    def is_full(self) -> bool: ...

    def clean(self) -> int: ...

    def sample(self, batch_size: int) -> Batch: ...

    def get(self, batch_size: int) -> Batch: ...
